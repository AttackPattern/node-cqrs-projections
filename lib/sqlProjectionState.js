"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _mongoose=_interopRequireDefault(require("mongoose"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function asyncGeneratorStep(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(t,n){var r=c.apply(e,i);function o(e){asyncGeneratorStep(r,t,n,o,a,"next",e)}function a(e){asyncGeneratorStep(r,t,n,o,a,"throw",e)}o(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var defaultKey="sql.projectionState",ProjectionStateSchema=new _mongoose.default.Schema({id:String,bookmark:Number}),activeDataKey="sql.activeKey",ActiveDataSchema=new _mongoose.default.Schema({id:String,key:String}),ProjectionState=function e(){var o=this;_classCallCheck(this,e),_defineProperty(this,"getActiveKey",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.ActiveDataModel.findOne({id:activeDataKey});case 2:return(null==(t=e.sent)?void 0:t.key)&&(o.key="".concat(defaultKey,".").concat(null==t?void 0:t.key),o.ProjectionStateModel=_mongoose.default.model(o.key,ProjectionStateSchema)),e.abrupt("return",(null==t?void 0:t.key)||"");case 5:case"end":return e.stop()}},e)}))),_defineProperty(this,"setKey",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.ActiveDataModel.findOne({id:activeDataKey});case 2:return(n=e.sent)||((n=new o.ActiveDataModel).id=activeDataKey),n.key=t,e.next=7,n.save();case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),_defineProperty(this,"bookmark",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.ProjectionStateModel.findOne({id:defaultKey});case 2:if((t=e.sent)||((t=new o.ProjectionStateModel).id=defaultKey),t.bookmark){e.next=8;break}return t.bookmark=0,e.next=8,t.save();case 8:return e.abrupt("return",t.bookmark);case 9:case"end":return e.stop()}},e)}))),_defineProperty(this,"setBookmark",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.ProjectionStateModel.findOne({id:defaultKey});case 2:return(n=e.sent)||((n=new o.ProjectionStateModel).id=defaultKey),n.bookmark=t,e.next=7,n.save();case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),_defineProperty(this,"reset",function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(defaultKey,".").concat(t.key),r=o.ProjectionStateModel,o.ProjectionStateModel=_mongoose.default.model(n,ProjectionStateSchema),e.next=5,o.ProjectionStateModel.findOneAndUpdate({id:defaultKey},{bookmark:0},{upsert:!0});case 5:r.collection.drop(),o.key=n,o.setKey(t.key);case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),this.key=defaultKey,this.ProjectionStateModel=_mongoose.default.model(defaultKey,ProjectionStateSchema),this.ActiveDataModel=_mongoose.default.model(activeDataKey,ActiveDataSchema)};exports.default=ProjectionState;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNxbFByb2plY3Rpb25TdGF0ZS5qcyJdLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImRlZmF1bHRLZXkiLCJQcm9qZWN0aW9uU3RhdGVTY2hlbWEiLCJtb25nb29zZSIsIlNjaGVtYSIsImlkIiwiU3RyaW5nIiwiYm9va21hcmsiLCJOdW1iZXIiLCJhY3RpdmVEYXRhS2V5IiwiQWN0aXZlRGF0YVNjaGVtYSIsImtleSIsIlByb2plY3Rpb25TdGF0ZSIsIl90aGlzIiwidGhpcyIsIl9jbGFzc0NhbGxDaGVjayIsIl9kZWZpbmVQcm9wZXJ0eSIsIl9hc3luY1RvR2VuZXJhdG9yIiwicmVnZW5lcmF0b3JSdW50aW1lIiwibWFyayIsIkFjdGl2ZURhdGFNb2RlbCIsImZpbmRPbmUiLCJzdGF0ZSIsIl9yZWYyIiwiYWN0aXZlS2V5Iiwic2F2ZSIsIl94IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfY2FsbGVlMyIsIndyYXAiLCJfY29udGV4dDMiLCJwcmV2IiwibmV4dCIsIlByb2plY3Rpb25TdGF0ZU1vZGVsIiwic2VudCIsImFicnVwdCIsInN0b3AiLCJfcmVmNCIsIl9jYWxsZWU0IiwiX2NvbnRleHQ0IiwiX3gyIiwiX3JlZjUiLCJfY2FsbGVlNSIsImFjdGl2ZVN0YXRlIiwibmV3S2V5Iiwib2xkTW9kZWwiLCJfY29udGV4dDUiLCJjb25jYXQiLCJmaW5kT25lQW5kVXBkYXRlIiwidXBzZXJ0IiwiY29sbGVjdGlvbiIsImRyb3AiLCJzZXRLZXkiLCJfeDMiLCJtb2RlbCJdLCJtYXBwaW5ncyI6IjJGQUFBLElBQUFBLFVBQUFDLHVCQUFBQyxRQUFBLG9zQkFFQSxJQUFNQyxXQUFhLHNCQUNiQyxzQkFBd0IsSUFBSUMsVUFBQUEsUUFBU0MsT0FBTyxDQUM1Q0MsR0FBSUMsT0FDSkMsU0FBVUMsU0FHWkMsY0FBZ0IsZ0JBQ2RDLGlCQUFtQixJQUFJUCxVQUFBQSxRQUFTQyxPQUFPLENBQ3pDQyxHQUFJQyxP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QUFHLE9BS0MsS0FBQSxFQUFBLElBQUEsTUFBQSxPQUFBZSxFQUFBSCxTQUFBRSxNQUxELE9BQUEsU0FBQUUsR0FBQSxPQUFBSCxFQUFBWCxNQUFBYixLQUFBYyxZQUFBLElBQUFaLGdCQUFBRixLQUFBLFFBQUEsV0FBQSxJQUFBNEIsRUFBQXpCLGtCQUFBQyxtQkFBQUMsS0FlTCxTQUFBd0IsRUFBQUMsR0FBQSxJQUFBQyxFQUFBQyxFQUFBLE9BQUE1QixtQkFBQVksS0FBQSxTQUFBaUIsR0FBQSxPQUFBLE9BQUFBLEVBQUFmLEtBQUFlLEVBQUFkLE1BQUEsS0FBQSxFQUFBLE9BQUFZLEVBQUEsR0FBQUcsT0FBQS9DLFdBQUEsS0FBQStDLE9BQUFKLEVBQUFqQyxLQUFBbUMsRUFBQWpDLEVBQUFxQixxQkFBQXJCLEVBQUFxQixxQkFDZ0JkLFVBQUFBLFFBQUFBLE1BQWdCQyxFQUFRbkIsdUJBRHhDNkMsRUFBQWQsS0FBQSxFQXNERHBCLEVBQUtxQixxQkF0REplLGlCQUFBLENBQUE1QyxHQUFBSixZQUFBLENBQUFNLFNBQUEsR0FBQSxDQUFBMkMsUUFBQSxJQUFBLEtBQUEsRUF5RFBKLEVBQVNLLFdBQVdDLE9BdERwQnZDLEVBQUFGLElBQUFrQyxFQXlEQWhDLEVBQUt3QyxPQUFPVCxFQUFZakMsS0E1RGpCLEtBQUEsRUFBQSxJQUFBLE1BQUEsT0FBQW9DLEVBQUFWLFNBQUFNLE1BZkssT0FBQSxTQUFBVyxHQUFBLE9BQUFaLEVBQUFmLE1BQUFiLEtBQUFjLFlBQUEsSUFDWmQsS0FBS0gsSUFBTVYsV0FDWGEsS0FBS29CLHFCQUF1Qi9CLFVBQUFBLFFBQVNvRCxNQUFNdEQsV0FBWUMsdUJBQ3ZEWSxLQUFLTSxnQkFBa0JqQixVQUFBQSxRQUFTb0QsTUFBTTlDLGNBQWVDIiwiZmlsZSI6InNxbFByb2plY3Rpb25TdGF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5cbmNvbnN0IGRlZmF1bHRLZXkgPSAnc3FsLnByb2plY3Rpb25TdGF0ZSc7XG5jb25zdCBQcm9qZWN0aW9uU3RhdGVTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcbiAgICAgIGlkOiBTdHJpbmcsXG4gICAgICBib29rbWFyazogTnVtYmVyXG4gIH0pO1xuXG5sZXQgYWN0aXZlRGF0YUtleSA9ICdzcWwuYWN0aXZlS2V5JztcbmNvbnN0IEFjdGl2ZURhdGFTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcbiAgICBpZDogU3RyaW5nLFxuICAgIGtleTogU3RyaW5nXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvamVjdGlvblN0YXRlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5rZXkgPSBkZWZhdWx0S2V5O1xuICAgIHRoaXMuUHJvamVjdGlvblN0YXRlTW9kZWwgPSBtb25nb29zZS5tb2RlbChkZWZhdWx0S2V5LCBQcm9qZWN0aW9uU3RhdGVTY2hlbWEpO1xuICAgIHRoaXMuQWN0aXZlRGF0YU1vZGVsID0gbW9uZ29vc2UubW9kZWwoYWN0aXZlRGF0YUtleSwgQWN0aXZlRGF0YVNjaGVtYSk7XG4gIH1cbiAgZ2V0QWN0aXZlS2V5ID0gYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHN0YXRlID0gYXdhaXQgdGhpcy5BY3RpdmVEYXRhTW9kZWwuZmluZE9uZSh7IGlkOiBhY3RpdmVEYXRhS2V5IH0pO1xuICAgICAgLy8gY2hhbmdlIG92ZXIgUHJvamVjdGlvblN0YXRlIGtleSBhcyB3ZWxsLlxuICAgICAgaWYgKHN0YXRlPy5rZXkpIHtcbiAgICAgICAgdGhpcy5rZXkgPSBgJHtkZWZhdWx0S2V5fS4ke3N0YXRlPy5rZXl9YDtcbiAgICAgICAgdGhpcy5Qcm9qZWN0aW9uU3RhdGVNb2RlbCA9IG1vbmdvb3NlLm1vZGVsKHRoaXMua2V5LCBQcm9qZWN0aW9uU3RhdGVTY2hlbWEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN0YXRlPy5rZXkgfHwgJyc7XG4gIH1cblxuICBzZXRLZXkgPSBhc3luYyBhY3RpdmVLZXkgPT4ge1xuICAgIGxldCBzdGF0ZSA9IGF3YWl0IHRoaXMuQWN0aXZlRGF0YU1vZGVsLmZpbmRPbmUoeyBpZDogYWN0aXZlRGF0YUtleSB9KTtcblxuICAgIGlmICghc3RhdGUpIHtcbiAgICAgIHN0YXRlID0gbmV3IHRoaXMuQWN0aXZlRGF0YU1vZGVsKCk7XG4gICAgICAvLyBhbHdheXMgc2V0IHRoZSBpZCB0byB0aGUga2V5LCB3ZSBvbmx5IGV2ZXIgd2FudCB0byBzZWFyY2ggYWdhaW5zdCB0aGlzIG9uZSBrZXlcbiAgICAgIHN0YXRlLmlkID0gYWN0aXZlRGF0YUtleTtcbiAgICB9XG5cbiAgICBzdGF0ZS5rZXkgPSBhY3RpdmVLZXk7XG4gICAgYXdhaXQgc3RhdGUuc2F2ZSgpO1xuICB9XG5cbiAgYm9va21hcmsgPSBhc3luYyAoKSA9PiB7XG4gICAgLy8gT2sgdGhpcyBpcyBjb25mdXNpbmcsIHNvIGxldHMgZXhwbGFpbiBpdC4gIFdlIHNpbXBseSBuZWVkIGEgc2luZ2xlIGVudHJ5IGluIGEgY29sbGVjdGlvbi5cbiAgICAvLyB0aHVzIHdlIGp1c3QgdGFnIHRoZSBpZCBhcyB0aGUgZGVmYXVsdEtleSBhbmQgc2VhcmNoIHRvIHNlZSBpZiBpdCBleGlzdHMuICBZb3UgbWlnaHQgYmVcbiAgICAvLyB0ZW1wdGVkIHRvIHVzZSB0aGlzLmtleSwgYnV0IHRoYXQncyBhIG1pc3Rha2UgYXMgdGhhdCdzIHdoYXQgY29udHJvbHMgdGhlIG1vZGVsLiAgd2UgYWx3YXlzXG4gICAgLy8gd2FudCB0byBzdG9yZSB0aGUgdmFsdWUgb2Ygb2YgYm9va21hcmtzIChhbmQgcHJvamVjdGlvbiBzdGF0ZSkgaW4gdGhlIGRlZmF1bHRLZXlcbiAgICB2YXIgc3RhdGUgPSBhd2FpdCB0aGlzLlByb2plY3Rpb25TdGF0ZU1vZGVsLmZpbmRPbmUoeyBpZDogZGVmYXVsdEtleSB9KTtcblxuICAgIGlmICghc3RhdGUpIHtcbiAgICAgIHN0YXRlID0gbmV3IHRoaXMuUHJvamVjdGlvblN0YXRlTW9kZWwoKTtcbiAgICAgIC8vIHJlbWVtYmVyIGFsd2F5cyB1c2UgZGVmYXVsdCBLZXkgZm9yIHN0b3JpbmcgdGhlIHZhbHVlIGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICBzdGF0ZS5pZCA9IGRlZmF1bHRLZXk7XG4gICAgfVxuXG4gICAgaWYgKCFzdGF0ZS5ib29rbWFyaykge1xuICAgICAgc3RhdGUuYm9va21hcmsgPSAwO1xuICAgICAgYXdhaXQgc3RhdGUuc2F2ZSgpO1xuICAgIH1cblxuICAgIHJldHVybiBzdGF0ZS5ib29rbWFyaztcbiAgfVxuXG4gIHNldEJvb2ttYXJrID0gYXN5bmMgYm9va21hcmsgPT4ge1xuICAgIGxldCBzdGF0ZSA9IGF3YWl0IHRoaXMuUHJvamVjdGlvblN0YXRlTW9kZWwuZmluZE9uZSh7IGlkOiBkZWZhdWx0S2V5IH0pO1xuXG4gICAgaWYgKCFzdGF0ZSkge1xuICAgICAgc3RhdGUgPSBuZXcgdGhpcy5Qcm9qZWN0aW9uU3RhdGVNb2RlbCgpO1xuICAgICAgLy8gcmVtZW1iZXIgYWx3YXlzIHVzZSBkZWZhdWx0IEtleSBmb3Igc3RvcmluZyB0aGUgdmFsdWUgaW4gdGhlIGNvbGxlY3Rpb25cbiAgICAgIHN0YXRlLmlkID0gZGVmYXVsdEtleTtcbiAgICB9XG5cbiAgICBzdGF0ZS5ib29rbWFyayA9IGJvb2ttYXJrO1xuICAgIGF3YWl0IHN0YXRlLnNhdmUoKTtcbiAgfVxuXG4gIHJlc2V0ID0gYXN5bmMgYWN0aXZlU3RhdGUgPT4ge1xuICAgIGNvbnN0IG5ld0tleSA9IGAke2RlZmF1bHRLZXl9LiR7YWN0aXZlU3RhdGUua2V5fWA7XG4gICAgY29uc3Qgb2xkTW9kZWwgPSB0aGlzLlByb2plY3Rpb25TdGF0ZU1vZGVsO1xuICAgIC8vIHdlIHVwZGF0ZSB0aGUgc2NoZW1hIHRvIHBvaW50IHRvIHRoZSBuZXcga2V5XG4gICAgdGhpcy5Qcm9qZWN0aW9uU3RhdGVNb2RlbCA9IG1vbmdvb3NlLm1vZGVsKG5ld0tleSwgUHJvamVjdGlvblN0YXRlU2NoZW1hKTtcbiAgICAvLyBSZWFsbHkgdGhpcyBpcyBjcmVhdGluZyBhIG5ldyBtb2RlbCBhbGwgdG9nZXRoZXIgc2luY2UgdGhlIG1vZGVsIGtleVxuICAgIC8vIGp1c3QgY2hhbmdlZC5cbiAgICBhd2FpdCB0aGlzLlByb2plY3Rpb25TdGF0ZU1vZGVsXG4gICAgICAuZmluZE9uZUFuZFVwZGF0ZSh7IGlkOiBkZWZhdWx0S2V5IH0sIHsgYm9va21hcms6IDAgfSwgeyB1cHNlcnQ6IHRydWUgfSk7XG5cbiAgICBvbGRNb2RlbC5jb2xsZWN0aW9uLmRyb3AoKTtcbiAgICB0aGlzLmtleSA9IG5ld0tleTtcbiAgICAvLyBzYXZlIHRoZSBrZXkgaW4gdGhlIGRhdGFiYXNlIHNvIHdlIGRvbid0IGhhdmUgdG8gcmVidWlsZCB0aGUgZGF0YSBvbiBzdGFydHVwXG4gICAgdGhpcy5zZXRLZXkoYWN0aXZlU3RhdGUua2V5KTtcbiAgfVxufVxuIl19
